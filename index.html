<!DOCTYPE html>
<html lang="ko" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GWJ2 OB Workday - Bennett</title>
    
    <!-- Favicon -->
    <link rel="icon" href="https://raw.githubusercontent.com/qogmlwo000/gwj2pickpackhtp/main/Bennett.ico" type="image/x-icon">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --font-main: 'Noto Sans KR', sans-serif;
            
            /* Dark Mode Defaults */
            --bg-body: #0f172a;
            --bg-nav: #1e293b;
            --bg-glass: rgba(30, 41, 59, 0.85);
            --border: rgba(255, 255, 255, 0.1);
            --text-main: #f8fafc;
            --text-sub: #94a3b8;
            
            --primary: #6366f1;
            --primary-hover: #4f46e5;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            --input-bg: rgba(0,0,0,0.3);
            --table-head: rgba(0,0,0,0.4);
            --table-row-hover: rgba(255,255,255,0.03);
        }

        [data-theme="light"] {
            --bg-body: #f1f5f9;
            --bg-nav: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.95);
            --border: rgba(0, 0, 0, 0.1);
            --text-main: #1e293b;
            --text-sub: #64748b;
            
            --primary: #4f46e5;
            --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            
            --input-bg: #ffffff;
            --table-head: #f8fafc;
            --table-row-hover: #f1f5f9;
        }

        * { box-sizing: border-box; outline: none; }
        body { font-family: var(--font-main); background-color: var(--bg-body); color: var(--text-main); margin: 0; display: flex; height: 100vh; overflow: hidden; transition: 0.3s; user-select: none; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-body); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; transition: 0.3s; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-sub); }

        /* Navigation */
        nav { width: 260px; background: var(--bg-nav); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 24px; z-index: 100; box-shadow: 4px 0 12px rgba(0,0,0,0.1); }
        
        /* Premium Logo Design - Sophisticated & Elegant */
        .logo { 
            font-size: 1.3rem; 
            font-weight: 900; 
            margin-bottom: 40px; 
            display: flex; 
            align-items: center; 
            gap: 16px; 
            padding: 20px;
            background: linear-gradient(135deg, 
                rgba(99, 102, 241, 0.08) 0%, 
                rgba(139, 92, 246, 0.05) 100%);
            border-radius: 20px;
            border: 1px solid rgba(99, 102, 241, 0.15);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            backdrop-filter: blur(10px);
        }
        
        /* Subtle gradient border on hover */
        .logo::before {
            content: '';
            position: absolute;
            inset: -1px;
            background: linear-gradient(135deg, #6366f1, #a78bfa);
            border-radius: 20px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.4s;
        }
        
        .logo:hover::before {
            opacity: 1;
        }
        
        /* Elegant shine effect */
        .logo::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.08),
                transparent
            );
            transition: left 0.6s;
        }
        
        .logo:hover::after {
            left: 100%;
        }
        
        .logo:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 12px 24px rgba(99, 102, 241, 0.15),
                0 0 0 1px rgba(99, 102, 241, 0.1);
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        /* Sophisticated icon with depth */
        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 4px 12px rgba(99, 102, 241, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .logo:hover .logo-icon {
            transform: scale(1.05);
            box-shadow: 
                0 6px 16px rgba(99, 102, 241, 0.35),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }
        
        .logo-icon i {
            font-size: 1.5rem;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        /* Clean, readable text */
        .logo-text { 
            line-height: 1.2; 
            position: relative;
            z-index: 1;
        }
        
        .logo-text .main { 
            font-size: 1.5rem; 
            display: block; 
            color: var(--text-main);
            font-weight: 900;
            letter-spacing: -0.5px;
            margin-bottom: 2px;
        }
        
        .logo-text .sub { 
            font-size: 0.75rem; 
            font-weight: 600; 
            color: var(--text-sub);
            display: block;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            opacity: 0.8;
        }
        
        .logo:hover .logo-text .sub {
            color: var(--primary);
            opacity: 1;
        }
        
        /* Nav Items with Premium Hover */
        .nav-item { 
            padding: 14px 16px; 
            margin-bottom: 8px; 
            border-radius: 12px; 
            cursor: pointer; 
            color: var(--text-sub); 
            font-weight: 500; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            position: relative;
            overflow: hidden;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 0;
            background: var(--primary);
            border-radius: 0 3px 3px 0;
            transition: height 0.3s;
        }
        
        .nav-item:hover { 
            background: var(--border); 
            color: var(--text-main); 
            transform: translateX(4px);
        }
        
        .nav-item:hover::before {
            height: 70%;
        }
        
        .nav-item.active { 
            background: linear-gradient(90deg, var(--primary) 0%, #4f46e5 100%); 
            color: white; 
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            transform: translateX(4px);
        }
        
        .nav-item.active::before {
            height: 70%;
            background: white;
        }
        
        .nav-item i {
            font-size: 1.1rem;
            transition: transform 0.3s;
        }
        
        .nav-item:hover i {
            transform: scale(1.2);
        }

        main { flex: 1; padding: 40px; overflow-y: auto; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        
        /* Sophisticated Theme Toggle Switch */
        .theme-toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .theme-toggle {
            position: relative;
            width: 140px;
            height: 42px;
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 24px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }
        
        .theme-toggle:hover {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        /* Sliding background */
        .theme-toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 64px;
            height: 32px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
        }
        
        [data-theme="light"] .theme-toggle-slider {
            left: calc(100% - 67px);
            background: linear-gradient(135deg, #f59e0b, #f97316);
        }
        
        /* Options container */
        .theme-options {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 8px;
        }
        
        .theme-option {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            font-size: 0.8rem;
            font-weight: 700;
            transition: all 0.3s;
            z-index: 1;
            color: var(--text-sub);
        }
        
        .theme-option i {
            font-size: 1rem;
        }
        
        /* Active state colors */
        [data-theme="dark"] .theme-option.dark {
            color: white;
        }
        
        [data-theme="light"] .theme-option.light {
            color: white;
        }
        
        /* Icons */
        .theme-option.dark i {
            color: #6366f1;
        }
        
        .theme-option.light i {
            color: #f59e0b;
        }
        
        [data-theme="dark"] .theme-option.dark i {
            color: white;
        }
        
        [data-theme="light"] .theme-option.light i {
            color: white;
        }

        /* Widgets */
        .summary-widgets { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .widget-card { background: var(--bg-glass); border: 1px solid var(--border); border-radius: 16px; padding: 20px; display: flex; align-items: center; gap: 16px; box-shadow: var(--card-shadow); transition: 0.2s; }
        .widget-card:hover { transform: translateY(-2px); box-shadow: 0 8px 16px rgba(0,0,0,0.4); }
        .widget-icon { width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; color: white; }
        .widget-text div:first-child { font-size: 0.85rem; color: var(--text-sub); font-weight: 600; text-transform: uppercase; }
        .widget-text div:last-child { font-size: 1.5rem; font-weight: 800; color: var(--text-main); }

        /* Tables */
        .table-card { background: var(--bg-nav); border-radius: 16px; border: 1px solid var(--border); overflow: hidden; padding: 0; margin-bottom: 24px; }
        .table-header { padding: 16px 24px; display: flex; justify-content: space-between; align-items: center; background: var(--table-head); border-bottom: 1px solid var(--border); }
        .weekly-table { width: 100%; border-collapse: separate; border-spacing: 0; }
        .weekly-table th { text-align: left; padding: 16px; background: var(--table-head); color: var(--text-sub); font-size: 0.8rem; text-transform: uppercase; border-bottom: 2px solid var(--border); }
        .weekly-table td { padding: 12px 16px; border-bottom: 1px solid var(--border); vertical-align: middle; background: var(--bg-glass); transition: 0.2s; }
        .weekly-table tbody tr:hover td { background: var(--table-row-hover); }
        
        .tbl-gauge { width: 100%; height: 6px; background: var(--border); border-radius: 4px; overflow: hidden; margin-top: 6px; }
        .tbl-fill { height: 100%; border-radius: 4px; transition: width 0.5s; }
        
        .row-danger td { background: rgba(239, 68, 68, 0.08) !important; color: var(--danger); font-weight: 700; border-top: 1px solid rgba(239,68,68,0.2); border-bottom: 1px solid rgba(239,68,68,0.2); }
        .row-danger { animation: pulse-red 2s infinite; }
        @keyframes pulse-red { 0% { box-shadow: inset 0 0 0 0 rgba(239, 68, 68, 0); } 50% { box-shadow: inset 0 0 10px 0 rgba(239, 68, 68, 0.2); } 100% { box-shadow: inset 0 0 0 0 rgba(239, 68, 68, 0); } }
        
        .row-warning td { color: var(--warning); background: rgba(245, 158, 11, 0.05) !important; }
        .status-badge { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 800; display: inline-block; width: 60px; text-align: center; }
        .bg-danger { background: var(--danger); color: white; }
        .bg-warning { background: var(--warning); color: #1e293b; }
        .bg-safe { background: var(--success); color: white; }

        /* Custom Select & Inputs */
        .custom-select { position: relative; }
        .custom-select select { appearance: none; width: 100%; padding: 12px 40px 12px 12px; background: var(--input-bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text-main); font-family: var(--font-main); cursor: pointer; transition: 0.2s; }
        .custom-select select:hover { border-color: var(--primary); }
        .custom-select::after { content: '\f078'; font-family: 'Font Awesome 6 Free'; font-weight: 900; position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--text-sub); pointer-events: none; }

        input[type="date"], input[type="time"] { appearance: none; width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text-main); font-family: var(--font-main); cursor: pointer; transition: 0.2s; }
        input[type="date"]:hover, input[type="time"]:hover { border-color: var(--primary); }
        input[type="date"]::-webkit-calendar-picker-indicator, input[type="time"]::-webkit-calendar-picker-indicator { filter: invert(0.6); cursor: pointer; }
        [data-theme="light"] input[type="date"]::-webkit-calendar-picker-indicator, [data-theme="light"] input[type="time"]::-webkit-calendar-picker-indicator { filter: invert(0.4); }

        /* Modern Time Picker */
        input[type="time"]::-webkit-datetime-edit { padding: 0; }
        input[type="time"]::-webkit-datetime-edit-fields-wrapper { padding: 0; }
        input[type="time"]::-webkit-datetime-edit-text { color: var(--text-sub); padding: 0 2px; }
        input[type="time"]::-webkit-datetime-edit-hour-field, 
        input[type="time"]::-webkit-datetime-edit-minute-field { 
            background: rgba(99, 102, 241, 0.1); 
            border-radius: 4px; 
            padding: 4px 8px; 
            color: var(--text-main); 
            font-weight: 600;
        }
        input[type="time"]::-webkit-calendar-picker-indicator { 
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%236366f1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>') center/contain no-repeat;
            width: 20px;
            height: 20px;
            filter: none;
            opacity: 0.8;
            transition: 0.2s;
        }
        input[type="time"]:hover::-webkit-calendar-picker-indicator { opacity: 1; transform: scale(1.1); }

        /* Modern Date Picker */
        input[type="date"]::-webkit-datetime-edit { padding: 0; }
        input[type="date"]::-webkit-datetime-edit-fields-wrapper { padding: 0; }
        input[type="date"]::-webkit-datetime-edit-text { color: var(--text-sub); padding: 0 2px; }
        input[type="date"]::-webkit-datetime-edit-year-field,
        input[type="date"]::-webkit-datetime-edit-month-field,
        input[type="date"]::-webkit-datetime-edit-day-field { 
            background: rgba(99, 102, 241, 0.1); 
            border-radius: 4px; 
            padding: 4px 6px; 
            color: var(--text-main); 
            font-weight: 600;
        }
        input[type="date"]::-webkit-calendar-picker-indicator { 
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%236366f1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>') center/contain no-repeat;
            width: 20px;
            height: 20px;
            filter: none;
            opacity: 0.8;
            transition: 0.2s;
        }
        input[type="date"]:hover::-webkit-calendar-picker-indicator { opacity: 1; transform: scale(1.1); }

        /* Analysis Panel */
        .split-layout { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; align-items: start; }
        .analysis-panel { background: var(--bg-glass); border: 2px solid var(--border); border-radius: 16px; padding: 24px; position: sticky; top: 20px; }
        .progress-container { margin-top: 15px; }
        .progress-labels { display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 6px; color: var(--text-sub); }
        .progress-track { width: 100%; height: 8px; background: var(--border); border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; border-radius: 10px; transition: width 0.5s; }

        /* Form */
        .form-container { background: var(--bg-glass); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
        /* Form Redesign - Modern Input Style */
        .form-container { background: var(--bg-glass); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
        
        .modern-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }
        
        .modern-input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .modern-input-group label {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .modern-input-group label i {
            color: var(--primary);
        }
        
        .modern-input-wrapper {
            position: relative;
        }
        
        .modern-input-wrapper input,
        .modern-input-wrapper select {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-main);
            font-family: var(--font-main);
            font-size: 0.95rem;
            transition: all 0.3s;
        }
        
        .modern-input-wrapper input:focus,
        .modern-input-wrapper select:focus {
            border-color: var(--primary);
            background: var(--input-bg);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .modern-input-wrapper input:hover,
        .modern-input-wrapper select:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        /* Time Preset Buttons */
        .time-presets {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }
        
        .time-preset-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);
        }
        
        .time-preset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        .time-preset-btn:active {
            transform: translateY(0);
        }
        
        /* Calculated Result Display */
        .calculated-result {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.05));
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 8px;
        }
        
        .calculated-result .label {
            font-size: 0.9rem;
            color: var(--text-sub);
            font-weight: 600;
        }
        
        .calculated-result .value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .calculated-result .value i {
            font-size: 1.2rem;
        }
        
        /* Submit Button Enhancement */
        .submit-btn {
            padding: 16px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 16px rgba(99, 102, 241, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .submit-btn i {
            font-size: 1.1rem;
        }
        
        /* Reason Input Special Style */
        .reason-input {
            grid-column: 1 / -1;
        }
        
        .reason-input textarea {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-main);
            font-family: var(--font-main);
            font-size: 0.95rem;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s;
        }
        
        .reason-input textarea:focus {
            border-color: var(--primary);
            background: var(--input-bg);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .reason-input textarea:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        /* Custom Modern Date Picker */
        .custom-date-picker {
            position: relative;
        }
        
        .custom-date-input {
            width: 100%;
            padding: 14px 16px 14px 45px;
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-main);
            font-family: var(--font-main);
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .custom-date-input:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .custom-date-input.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .date-display {
            font-weight: 600;
            color: var(--text-main);
        }
        
        .date-display.placeholder {
            color: var(--text-sub);
            font-weight: 400;
        }
        
        .calendar-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: var(--bg-nav);
            border: 2px solid var(--primary);
            border-radius: 16px;
            padding: 12px;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: none;
            animation: slideDown 0.3s ease;
            max-width: 320px;
        }
        
        .calendar-dropdown.show {
            display: block;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .calendar-nav-btn {
            width: 28px;
            height: 28px;
            border-radius: 8px;
            border: none;
            background: var(--border);
            color: var(--text-main);
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .calendar-nav-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        .calendar-month-year {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-main);
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 4px;
        }
        
        .calendar-weekday {
            text-align: center;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-sub);
            padding: 6px 0;
        }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            border: none;
            background: transparent;
            color: var(--text-main);
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
            font-weight: 500;
            font-size: 0.85rem;
            padding: 6px;
        }
        
        .calendar-day:hover {
            background: var(--border);
        }
        
        .calendar-day.today {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
            font-weight: 700;
        }
        
        .calendar-day.selected {
            background: var(--primary);
            color: white;
            font-weight: 700;
        }
        
        .calendar-day.other-month {
            color: var(--text-sub);
            opacity: 0.4;
        }
        
        .calendar-day:disabled {
            cursor: not-allowed;
            opacity: 0.3;
        }
        
        /* Custom Modern Time Picker */
        .custom-time-picker {
            position: relative;
        }
        
        .custom-time-input {
            width: 100%;
            padding: 14px 16px 14px 45px;
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-main);
            font-family: var(--font-main);
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .custom-time-input:hover {
            border-color: rgba(99, 102, 241, 0.5);
        }
        
        .custom-time-input.active {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
        }
        
        .time-display {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
            letter-spacing: 1px;
        }
        
        .time-display.placeholder {
            color: var(--text-sub);
            font-weight: 400;
            font-size: 0.95rem;
        }
        
        .time-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            right: 0;
            background: var(--bg-nav);
            border: 2px solid var(--primary);
            border-radius: 16px;
            padding: 20px;
            z-index: 1000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            display: none;
            animation: slideDown 0.3s ease;
        }
        
        .time-dropdown.show {
            display: block;
        }
        
        .time-selector {
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: center;
        }
        
        .time-column {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .time-label {
            font-size: 0.75rem;
            color: var(--text-sub);
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .time-scroll {
            height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 4px;
            border-radius: 8px;
            background: var(--input-bg);
        }
        
        .time-scroll::-webkit-scrollbar {
            width: 6px;
        }
        
        .time-scroll::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }
        
        .time-option {
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
            font-weight: 600;
            color: var(--text-main);
            min-width: 60px;
        }
        
        .time-option:hover {
            background: var(--border);
        }
        
        .time-option.selected {
            background: var(--primary);
            color: white;
        }
        
        .time-separator {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            padding-top: 50px;
        }
        
        .time-confirm-btn {
            margin-top: 16px;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.3s;
        }
        
        .time-confirm-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
        }

        /* Modern Date/Time Input Icons */
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            pointer-events: none;
            font-size: 1.1rem;
        }
        
        .input-with-icon input,
        .input-with-icon select {
            padding-left: 42px;
        }
        
        /* Quick Action Cards */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }
        
        .quick-action-card {
            background: var(--bg-nav);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .quick-action-card:hover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
        }
        
        .quick-action-card.active {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
        }
        
        .quick-action-card .time {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
        }
        
        .quick-action-card .label {
            font-size: 0.75rem;
            color: var(--text-sub);
            margin-top: 4px;
        }
        
        .input-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
        .input-group label { display: block; font-size: 0.8rem; color: var(--text-sub); margin-bottom: 8px; font-weight: 600; }
        .input-group input, .input-group select { width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text-main); font-family: var(--font-main); transition: 0.2s; }
        .input-group input:hover, .input-group select:hover { border-color: var(--primary); }
        .quick-btn-group { display: flex; gap: 6px; margin-top: 8px; }
        .quick-btn { background: var(--border); color: var(--text-sub); padding: 6px 10px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; transition: 0.2s; }
        .quick-btn:hover { background: var(--primary); color: white; }
        
        /* Dashboard Cards */
        .dash-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        
        /* Manager Card - Premium Style */
        .member-card.manager-card { 
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px; 
            padding: 24px; 
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
            position: relative;
            overflow: hidden;
        }
        .member-card.manager-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), #a78bfa);
        }
        .member-card.manager-card:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 8px 24px rgba(99, 102, 241, 0.2);
            border-color: var(--primary);
        }
        .member-card.manager-card .card-badge {
            background: linear-gradient(135deg, var(--primary), #a78bfa);
            color: white;
            font-size: 1.1rem;
            padding: 8px 16px;
            border-radius: 10px;
            font-weight: 800;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }
        
        /* Captain Card - Clean Style */
        .member-card.captain-card { 
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 16px; 
            padding: 20px; 
            transition: all 0.3s;
            box-shadow: var(--card-shadow);
            position: relative;
        }
        .member-card.captain-card:hover { 
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        .member-card.captain-card .card-badge {
            background: var(--bg-nav);
            color: var(--text-main);
            font-size: 1rem;
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 700;
            border: 1px solid var(--border);
        }

        .card-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .card-info div:first-child { font-size: 1.1rem; font-weight: 800; color: var(--text-main); }
        .card-info div:last-child { font-size: 0.85rem; color: var(--text-sub); margin-top: 4px; }
        
        .safe .progress-fill { background: var(--success); }
        .warning .progress-fill { background: var(--warning); }
        .warning { border-color: var(--warning) !important; }
        .warning { 
            border-color: var(--warning) !important; 
            animation: pulse-warning 2s ease-in-out infinite;
        }
        .danger { 
            border-color: var(--danger) !important; 
            animation: pulse-danger 1.5s ease-in-out infinite;
        }
        .danger .progress-fill { background: var(--danger); }
        
        /* Pulse Animations */
        @keyframes pulse-danger {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px 5px rgba(239, 68, 68, 0.2);
                transform: scale(1.02);
            }
        }
        
        @keyframes pulse-warning {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.3);
            }
            50% { 
                box-shadow: 0 0 15px 3px rgba(245, 158, 11, 0.15);
            }
        }
        
        /* Enhanced danger card effect */
        .member-card.danger .card-badge {
            animation: badge-pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes badge-pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 6px 20px rgba(239, 68, 68, 0.5);
            }
        }
        
        /* Warning card subtle pulse */
        .member-card.warning {
            animation: warning-glow 2s ease-in-out infinite;
        }
        
        @keyframes warning-glow {
            0%, 100% { 
                border-color: var(--warning);
            }
            50% { 
                border-color: rgba(245, 158, 11, 0.6);
            }
        }
        
        /* Alert box pulse animation */
        @keyframes alert-pulse {
            0%, 100% { 
                background: rgba(239, 68, 68, 0.15);
                border-color: var(--danger);
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
            }
            50% { 
                background: rgba(239, 68, 68, 0.25);
                border-color: #dc2626;
                box-shadow: 0 0 15px 2px rgba(239, 68, 68, 0.3);
            }
        }

        .btn { padding: 10px 20px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; font-family: var(--font-main); transition: 0.2s; }
        .btn:hover { transform: translateY(-1px); }
        .btn-primary { background: var(--primary); color: white; width: 100%; justify-content: center; }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-capture { background: #334155; color: white; font-size: 0.85rem; padding: 8px 16px; }
        .btn-capture:hover { background: #475569; }
        .btn-excel { background: #10b981; color: white; font-size: 0.85rem; padding: 8px 16px; }
        .btn-excel:hover { background: #059669; }
        .btn-del { background: rgba(239,68,68,0.15); color: var(--danger); padding: 6px 10px; border-radius: 6px; }
        .btn-del:hover { background: var(--danger); color: white; }

        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        #weeklyFullReport { background: var(--bg-glass); border-radius: 20px; padding: 20px; border: 1px solid var(--border); }
        #weeklyFullReport .summary-widgets { margin-bottom: 20px; }

        .action-buttons { display: flex; gap: 10px; }
        
        /* Calendar View Styles */
        .calendar-view-container {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }
        
        .calendar-view-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        
        .calendar-view-nav {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .calendar-view-nav button {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            border: none;
            background: var(--bg-nav);
            color: var(--text-main);
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }
        
        .calendar-view-nav button:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }
        
        .calendar-view-nav h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 800;
            min-width: 180px;
            text-align: center;
        }
        
        .calendar-view-today-btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            background: var(--primary);
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }
        
        .calendar-view-today-btn:hover {
            background: var(--primary-hover);
            transform: translateY(-2px);
        }
        
        .calendar-view-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .calendar-view-weekday {
            text-align: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-sub);
            padding: 12px 0;
            text-transform: uppercase;
        }
        
        .calendar-view-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .calendar-view-day {
            min-height: 120px;
            background: var(--bg-nav);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            flex-direction: column;
        }
        
        .calendar-view-day:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .calendar-view-day.other-month {
            opacity: 0.4;
        }
        
        .calendar-view-day.today {
            border: 2px solid var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }
        
        .calendar-view-day-number {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 8px;
        }
        
        .calendar-view-day.today .calendar-view-day-number {
            color: var(--primary);
        }
        
        .calendar-view-events {
            display: flex;
            flex-direction: column;
            gap: 4px;
            overflow-y: auto;
            max-height: 90px;
        }
        
        .calendar-view-events::-webkit-scrollbar {
            width: 4px;
        }
        
        .calendar-view-events::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 2px;
        }
        
        .calendar-event {
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: 0.2s;
        }
        
        .calendar-event:hover {
            transform: scale(1.02);
        }
        
        .calendar-event.overtime {
            background: rgba(99, 102, 241, 0.15);
            color: var(--primary);
            border-left: 3px solid var(--primary);
        }
        
        .calendar-event.early {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
            border-left: 3px solid var(--warning);
        }
        
        .calendar-event i {
            font-size: 0.65rem;
        }
        
        .calendar-event-name {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }
        
        .calendar-event-time {
            font-size: 0.65rem;
            opacity: 0.8;
        }
        
        .calendar-legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }
        
        .calendar-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .calendar-legend-icon {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }
        
        .calendar-legend-icon.overtime {
            background: var(--primary);
        }
        
        .calendar-legend-icon.early {
            background: var(--warning);
        }
        
        /* Search & Filter Bar */
        .search-filter-bar {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 16px;
            background: var(--input-bg);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-main);
            font-family: var(--font-main);
            transition: 0.2s;
        }
        
        .search-box input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .search-box i {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-sub);
        }
        
        .filter-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: var(--bg-nav);
            color: var(--text-sub);
            cursor: pointer;
            transition: 0.2s;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .filter-btn:hover {
            background: var(--border);
            color: var(--text-main);
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .filter-btn.filter-danger.active {
            background: var(--danger);
            border-color: var(--danger);
        }
        
        .filter-btn.filter-warning.active {
            background: var(--warning);
            border-color: var(--warning);
            color: #1e293b;
        }
        
        .filter-btn.filter-safe.active {
            background: var(--success);
            border-color: var(--success);
        }
        
        .clear-filters {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-sub);
            cursor: pointer;
            transition: 0.2s;
            font-size: 0.85rem;
        }
        
        .clear-filters:hover {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .dash-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .summary-widgets {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 968px) {
            body {
                flex-direction: column;
            }
            
            nav {
                width: 100%;
                flex-direction: row;
                padding: 16px;
                border-right: none;
                border-bottom: 1px solid var(--border);
                overflow-x: auto;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            
            .logo {
                margin-bottom: 0;
                margin-right: 20px;
                padding: 12px;
                min-width: 150px;
            }
            
            .logo-text .main {
                font-size: 1.1rem;
            }
            
            .logo-text .sub {
                font-size: 0.75rem;
            }
            
            .nav-item {
                white-space: nowrap;
                margin-bottom: 0;
                margin-right: 8px;
            }
            
            main {
                padding: 20px;
            }
            
            .split-layout {
                grid-template-columns: 1fr;
            }
            
            .analysis-panel {
                position: static;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .table-header {
                flex-direction: column;
                gap: 12px;
                align-items: flex-start;
            }
            
            .action-buttons {
                width: 100%;
                justify-content: stretch;
            }
            
            .action-buttons .btn {
                flex: 1;
            }
        }
        
        @media (max-width: 640px) {
            .summary-widgets {
                grid-template-columns: 1fr;
            }
            
            .dash-grid {
                grid-template-columns: 1fr;
            }
            
            .widget-card {
                padding: 16px;
            }
            
            .search-filter-bar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .filter-group {
                width: 100%;
            }
            
            .filter-btn {
                flex: 1;
                justify-content: center;
            }
            
            .weekly-table {
                font-size: 0.85rem;
            }
            
            .weekly-table th,
            .weekly-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>

    <nav>
        <div class="logo">
            <div class="logo-icon">
                <i class="fa-solid fa-layer-group"></i>
            </div>
            <div class="logo-text">
                <span class="main">GWJ2</span>
                <span class="sub">OB Workday</span>
            </div>
        </div>
        <div class="nav-item active" onclick="switchTab('dashboard')"><i class="fa-solid fa-chart-pie"></i> </div>
        <div class="nav-item" onclick="switchTab('calendar')"><i class="fa-solid fa-calendar-days"></i>  </div>
        <div class="nav-item" onclick="switchTab('weekly')"><i class="fa-solid fa-chart-simple"></i>   ()</div>
        <div class="nav-item" onclick="switchTab('overtime')"><i class="fa-solid fa-clock"></i>  </div>
        <div class="nav-item" onclick="switchTab('early')"><i class="fa-solid fa-sun"></i>  </div>
        <div class="nav-item" onclick="switchTab('team')"><i class="fa-solid fa-users-gear"></i>  </div>
    </nav>

    <main id="mainArea">
        <header>
            <h1 id="pageTitle"></h1>
            <div style="display:flex; gap:15px; align-items:center;">
                <div class="theme-toggle-container">
                    <div class="theme-toggle" onclick="toggleTheme()">
                        <div class="theme-toggle-slider"></div>
                        <div class="theme-options">
                            <div class="theme-option dark">
                                <i class="fa-solid fa-moon"></i>
                                <span>Dark</span>
                            </div>
                            <div class="theme-option light">
                                <i class="fa-solid fa-sun"></i>
                                <span>Light</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div style="font-size:0.9rem; color:var(--text-sub);">V 2.0</div>
            </div>
        </header>

        <div id="tab-dashboard" class="tab-content active">
            <!-- Search & Filter Bar -->
            <div class="search-filter-bar">
                <div class="search-box">
                    <input type="text" id="dashSearchInput" placeholder="   ..." oninput="applyDashFilters()">
                    <i class="fa-solid fa-search"></i>
                </div>
                <div class="filter-group">
                    <div class="filter-btn filter-danger" onclick="toggleDashFilter('danger')">
                        <i class="fa-solid fa-ban"></i> 
                    </div>
                    <div class="filter-btn filter-warning" onclick="toggleDashFilter('warning')">
                        <i class="fa-solid fa-triangle-exclamation"></i> 
                    </div>
                    <div class="filter-btn filter-safe" onclick="toggleDashFilter('safe')">
                        <i class="fa-solid fa-check"></i> 
                    </div>
                </div>
                <button class="clear-filters" onclick="clearDashFilters()">
                    <i class="fa-solid fa-rotate-right"></i> 
                </button>
            </div>
            
            <div style="display:flex; justify-content:space-between; align-items:flex-end; border-bottom:1px solid var(--border); padding-bottom:10px; margin-bottom:20px;">
                <div style="font-size:1.2rem; font-weight:700;"><i class="fa-solid fa-user-tie" style="color:#a78bfa"></i> Managers</div>
                <button class="btn btn-capture" onclick="captureSection('managerSection', 'Managers_Status')"><i class="fa-solid fa-camera"></i> </button>
            </div>
            <div id="managerSection"><div class="dash-grid" id="managerGrid"></div></div>

            <div style="display:flex; justify-content:space-between; align-items:flex-end; border-bottom:1px solid var(--border); padding-bottom:10px; margin-bottom:20px; margin-top:30px;">
                <div style="font-size:1.2rem; font-weight:700;"><i class="fa-solid fa-headset" style="color:#22d3ee"></i> Team Captains</div>
                <button class="btn btn-capture" onclick="captureSection('tcSection', 'TC_Status')"><i class="fa-solid fa-camera"></i> </button>
            </div>
            <div id="tcSection"><div class="dash-grid" id="tcGrid"></div></div>
        </div>

        <div id="tab-calendar" class="tab-content">
            <div class="calendar-view-container">
                <div class="calendar-view-header">
                    <div class="calendar-view-nav">
                        <button onclick="changeCalendarMonth(-1)">
                            <i class="fa-solid fa-chevron-left"></i>
                        </button>
                        <h2 id="calendarMonthYear">2026 1</h2>
                        <button onclick="changeCalendarMonth(1)">
                            <i class="fa-solid fa-chevron-right"></i>
                        </button>
                    </div>
                    <button class="calendar-view-today-btn" onclick="goToToday()">
                        <i class="fa-solid fa-calendar-day"></i> 
                    </button>
                </div>
                
                <div class="calendar-view-weekdays">
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                    <div class="calendar-view-weekday"></div>
                </div>
                
                <div class="calendar-view-days" id="calendarViewDays"></div>
                
                <div class="calendar-legend">
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-icon overtime"></div>
                        <span> </span>
                    </div>
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-icon early"></div>
                        <span> </span>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-weekly" class="tab-content">
            
            <div id="weeklyFullReport">
                <!-- Search & Filter Bar -->
                <div class="search-filter-bar">
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="   ..." oninput="applyFilters()">
                        <i class="fa-solid fa-search"></i>
                    </div>
                    <div class="filter-group">
                        <div class="filter-btn filter-danger" onclick="toggleFilter('danger')">
                            <i class="fa-solid fa-ban"></i> 
                        </div>
                        <div class="filter-btn filter-warning" onclick="toggleFilter('warning')">
                            <i class="fa-solid fa-triangle-exclamation"></i> 
                        </div>
                        <div class="filter-btn filter-safe" onclick="toggleFilter('safe')">
                            <i class="fa-solid fa-check"></i> 
                        </div>
                    </div>
                    <button class="clear-filters" onclick="clearFilters()">
                        <i class="fa-solid fa-rotate-right"></i> 
                    </button>
                </div>
                
                <div class="summary-widgets" id="weeklyWidgets"></div>

                <div class="table-card" id="weeklyReportArea">
                    <div class="table-header">
                        <div><h3 style="margin:0;">     </h3><span style="font-size:0.85rem; color:var(--text-sub);">52h     </span></div>
                        <div class="action-buttons">
                            <button class="btn btn-excel" onclick="exportToExcel('weekly')"><i class="fa-solid fa-file-excel"></i>  </button>
                            <button class="btn btn-capture" onclick="captureSection('weeklyFullReport', 'Weekly_Report')"><i class="fa-solid fa-camera"></i> </button>
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="weekly-table">
                            <thead>
                                <tr>
                                    <th width="5%" style="text-align:center;"></th>
                                    <th width="20%"> / </th>
                                    <th width="35%"> </th>
                                    <th width="15%" style="text-align:right"> </th>
                                    <th width="10%" style="text-align:center"></th>
                                    <th width="15%" style="text-align:right"></th>
                                </tr>
                            </thead>
                            <tbody id="weeklyTbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-overtime" class="tab-content">
            <div class="split-layout">
                <div>
                    <div class="form-container">
                        <h3 style="margin-top:0; margin-bottom:24px; display:flex; align-items:center; gap:10px;">
                            <i class="fa-solid fa-clock" style="color:var(--primary)"></i>
                              
                        </h3>
                        
                        <div class="modern-form">
                            <!-- Manager Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-user"></i>  </label>
                                <div class="modern-input-wrapper input-with-icon">
                                    <i class="fa-solid fa-user-tie"></i>
                                    <select id="otSelect" onchange="updateAnalysis('ot')">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Shift Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-business-time"></i>  </label>
                                <div class="modern-input-wrapper input-with-icon">
                                    <i class="fa-solid fa-users"></i>
                                    <select id="otShift" onchange="setShiftTime('ot')">
                                        <option value=""></option>
                                        <option value="day">DAY (09:00 ~ 18:00)</option>
                                        <option value="swing">SWING (19:00 ~ 04:00)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Date Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-calendar"></i>  </label>
                                <div class="custom-date-picker">
                                    <div class="modern-input-wrapper input-with-icon">
                                        <i class="fa-solid fa-calendar-day"></i>
                                        <div class="custom-date-input" onclick="toggleCalendar('ot')">
                                            <span class="date-display placeholder" id="otDateDisplay"> </span>
                                            <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                        </div>
                                        <input type="hidden" id="otDate">
                                    </div>
                                    <div class="calendar-dropdown" id="otCalendar">
                                        <div class="calendar-header">
                                            <button class="calendar-nav-btn" onclick="changeMonth('ot', -1)">
                                                <i class="fa-solid fa-chevron-left"></i>
                                            </button>
                                            <div class="calendar-month-year" id="otMonthYear"></div>
                                            <button class="calendar-nav-btn" onclick="changeMonth('ot', 1)">
                                                <i class="fa-solid fa-chevron-right"></i>
                                            </button>
                                        </div>
                                        <div class="calendar-weekdays">
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                        </div>
                                        <div class="calendar-days" id="otCalendarDays"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Time Range -->
                            <div class="form-row">
                                <div class="modern-input-group">
                                    <label><i class="fa-solid fa-clock"></i>  </label>
                                    <div class="custom-time-picker">
                                        <div class="modern-input-wrapper input-with-icon">
                                            <i class="fa-solid fa-play"></i>
                                            <div class="custom-time-input" onclick="toggleTimePicker('otStart')">
                                                <span class="time-display" id="otStartDisplay">18:00</span>
                                                <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                            </div>
                                            <input type="hidden" id="otStart" value="18:00">
                                        </div>
                                        <div class="time-dropdown" id="otStartPicker">
                                            <div class="time-selector">
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="otStartHour"></div>
                                                </div>
                                                <div class="time-separator">:</div>
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="otStartMinute"></div>
                                                </div>
                                            </div>
                                            <button class="time-confirm-btn" onclick="confirmTime('otStart')"></button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modern-input-group">
                                    <label><i class="fa-solid fa-clock"></i>  </label>
                                    <div class="custom-time-picker">
                                        <div class="modern-input-wrapper input-with-icon">
                                            <i class="fa-solid fa-stop"></i>
                                            <div class="custom-time-input" onclick="toggleTimePicker('otEnd')">
                                                <span class="time-display placeholder" id="otEndDisplay"> </span>
                                                <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                            </div>
                                            <input type="hidden" id="otEnd">
                                        </div>
                                        <div class="time-dropdown" id="otEndPicker">
                                            <div class="time-selector">
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="otEndHour"></div>
                                                </div>
                                                <div class="time-separator">:</div>
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="otEndMinute"></div>
                                                </div>
                                            </div>
                                            <button class="time-confirm-btn" onclick="confirmTime('otEnd')"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Quick Time Presets -->
                            <div style="margin-top:-8px;">
                                <div style="font-size:0.8rem; color:var(--text-sub); margin-bottom:8px; font-weight:600;">   </div>
                                <div class="time-presets">
                                    <button class="time-preset-btn" onclick="setQuickTime('ot',0.5)">
                                        <i class="fa-solid fa-plus"></i> 30
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTime('ot',1.0)">
                                        <i class="fa-solid fa-plus"></i> 1
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTime('ot',1.5)">
                                        <i class="fa-solid fa-plus"></i> 1.5
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTime('ot',2.0)">
                                        <i class="fa-solid fa-plus"></i> 2
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Calculated Time Display -->
                            <div class="calculated-result">
                                <div class="label"> </div>
                                <div class="value">
                                    <i class="fa-solid fa-hourglass-half"></i>
                                    <span id="otDiff">0.0h</span>
                                </div>
                            </div>
                            
                            <!-- Reason Input -->
                            <div class="modern-input-group reason-input">
                                <label><i class="fa-solid fa-comment"></i>  </label>
                                <textarea id="otReason" placeholder=":      "></textarea>
                            </div>
                            
                            <!-- Submit Button -->
                            <button class="submit-btn" onclick="addRequest('overtime')">
                                <i class="fa-solid fa-paper-plane"></i>
                                
                            </button>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="analysis-panel" id="otAnalysis" style="display:none;">
                        <div style="border-bottom:1px solid var(--border); padding-bottom:10px; margin-bottom:15px;">
                            <div style="font-size:1.3rem; font-weight:800;" id="otAnaName">-</div><div style="font-size:0.85rem;" id="otAnaRole">-</div>
                        </div>
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                            <span></span>
                            <div style="display:flex; align-items:center; gap:5px;">
                                <input type="number" id="otBase" value="40" style="width:50px; background:transparent; border:none; border-bottom:1px solid #999; color:inherit; text-align:right;" oninput="updateAnalysis('ot')">
                                <span style="color:var(--text-sub);">h</span>
                            </div>
                        </div>
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span></span><span style="font-weight:600;" id="otApproved">0.0 h</span></div>
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px; color:var(--primary);"><span>+ </span><span style="font-weight:600;" id="otCurrent">0.0 h</span></div>
                        <div style="border-top:1px solid var(--border); padding-top:10px; margin-top:15px; display:flex; justify-content:space-between; align-items:center;"><span style="font-size:1.1rem; font-weight:700;">  </span><span style="font-size:1.8rem; font-weight:800; color:var(--primary);" id="otTotal">40.0 h</span></div>
                        <div class="progress-container"><div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:5px;"><span>Limit: 52h</span><span id="otAnaRemain">12h</span></div><div class="progress-track"><div class="progress-fill" id="otAnaFill" style="width:76%; background:var(--success)"></div></div></div>
                        <div id="otAlertDanger" style="margin-top:15px; padding:12px; border-radius:10px; font-size:0.95rem; font-weight:700; text-align:center; display:none; background:rgba(239,68,68,0.15); color:var(--danger); border:2px solid var(--danger); animation: alert-pulse 1.5s ease-in-out infinite;">
                            <i class="fa-solid fa-triangle-exclamation"></i> : 52 !
                        </div>
                    </div>
                    <div id="otPlaceholder" style="text-align:center; padding:40px; color:var(--text-sub); border:2px dashed var(--border); border-radius:16px;"> .</div>
                </div>
            </div>
            <div class="table-card" id="otTableArea" style="margin-top:24px;">
                <div class="table-header">
                    <div style="flex:1;">
                        <h3 style="margin:0 0 8px 0;">   </h3>
                        <div style="display:flex; gap:12px; align-items:center;">
                            <label style="font-size:0.85rem; color:var(--text-sub); font-weight:600;">
                                <i class="fa-solid fa-calendar"></i>  :
                            </label>
                            <div style="display:flex; gap:8px;">
                                <button class="filter-btn" id="otFilterToday" onclick="setRequestDateFilter('overtime', 'today')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-day"></i> 
                                </button>
                                <button class="filter-btn" onclick="setRequestDateFilter('overtime', 'week')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-week"></i>  
                                </button>
                                <button class="filter-btn" onclick="setRequestDateFilter('overtime', 'all')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-days"></i> 
                                </button>
                            </div>
                            <div style="margin-left:8px; font-size:0.75rem; color:var(--text-sub);">
                                <span id="otFilterCount">0</span> 
                            </div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-excel" onclick="exportToExcel('overtime')"><i class="fa-solid fa-file-excel"></i> </button>
                        <button class="btn btn-capture" onclick="captureSection('otTableArea','Overtime_List')"><i class="fa-solid fa-camera"></i> </button>
                    </div>
                </div>
                <div style="overflow-x:auto;"><table class="weekly-table" id="otTable"><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th width="150"> </th><th></th><th></th></tr></thead><tbody id="otTbody"></tbody></table></div>
            </div>
        </div>

        <div id="tab-early" class="tab-content">
            <div class="split-layout">
                <div>
                    <div class="form-container">
                        <h3 style="margin-top:0; margin-bottom:24px; display:flex; align-items:center; gap:10px;">
                            <i class="fa-solid fa-sun" style="color:#f59e0b"></i>
                              
                        </h3>
                        
                        <div class="modern-form">
                            <!-- Manager Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-user"></i>  </label>
                                <div class="modern-input-wrapper input-with-icon">
                                    <i class="fa-solid fa-user-tie"></i>
                                    <select id="earlySelect" onchange="updateAnalysis('early')">
                                        <option value=""></option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Shift Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-business-time"></i>  </label>
                                <div class="modern-input-wrapper input-with-icon">
                                    <i class="fa-solid fa-users"></i>
                                    <select id="earlyShift" onchange="setShiftTime('early')">
                                        <option value=""></option>
                                        <option value="day">DAY (09:00 ~ 18:00)</option>
                                        <option value="swing">SWING (19:00 ~ 04:00)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Date Selection -->
                            <div class="modern-input-group">
                                <label><i class="fa-solid fa-calendar"></i>  </label>
                                <div class="custom-date-picker">
                                    <div class="modern-input-wrapper input-with-icon">
                                        <i class="fa-solid fa-calendar-day"></i>
                                        <div class="custom-date-input" onclick="toggleCalendar('early')">
                                            <span class="date-display placeholder" id="earlyDateDisplay"> </span>
                                            <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                        </div>
                                        <input type="hidden" id="earlyDate">
                                    </div>
                                    <div class="calendar-dropdown" id="earlyCalendar">
                                        <div class="calendar-header">
                                            <button class="calendar-nav-btn" onclick="changeMonth('early', -1)">
                                                <i class="fa-solid fa-chevron-left"></i>
                                            </button>
                                            <div class="calendar-month-year" id="earlyMonthYear"></div>
                                            <button class="calendar-nav-btn" onclick="changeMonth('early', 1)">
                                                <i class="fa-solid fa-chevron-right"></i>
                                            </button>
                                        </div>
                                        <div class="calendar-weekdays">
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                            <div class="calendar-weekday"></div>
                                        </div>
                                        <div class="calendar-days" id="earlyCalendarDays"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Time Range -->
                            <div class="form-row">
                                <div class="modern-input-group">
                                    <label><i class="fa-solid fa-clock"></i>  </label>
                                    <div class="custom-time-picker">
                                        <div class="modern-input-wrapper input-with-icon">
                                            <i class="fa-solid fa-play"></i>
                                            <div class="custom-time-input" onclick="toggleTimePicker('earlyStart')">
                                                <span class="time-display" id="earlyStartDisplay">08:00</span>
                                                <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                            </div>
                                            <input type="hidden" id="earlyStart" value="08:00">
                                        </div>
                                        <div class="time-dropdown" id="earlyStartPicker">
                                            <div class="time-selector">
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="earlyStartHour"></div>
                                                </div>
                                                <div class="time-separator">:</div>
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="earlyStartMinute"></div>
                                                </div>
                                            </div>
                                            <button class="time-confirm-btn" onclick="confirmTime('earlyStart')"></button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="modern-input-group">
                                    <label><i class="fa-solid fa-clock"></i>  </label>
                                    <div class="custom-time-picker">
                                        <div class="modern-input-wrapper input-with-icon">
                                            <i class="fa-solid fa-stop"></i>
                                            <div class="custom-time-input" onclick="toggleTimePicker('earlyEnd')">
                                                <span class="time-display" id="earlyEndDisplay">09:00</span>
                                                <i class="fa-solid fa-chevron-down" style="color:var(--text-sub); font-size:0.8rem;"></i>
                                            </div>
                                            <input type="hidden" id="earlyEnd" value="09:00">
                                        </div>
                                        <div class="time-dropdown" id="earlyEndPicker">
                                            <div class="time-selector">
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="earlyEndHour"></div>
                                                </div>
                                                <div class="time-separator">:</div>
                                                <div class="time-column">
                                                    <div class="time-label"></div>
                                                    <div class="time-scroll" id="earlyEndMinute"></div>
                                                </div>
                                            </div>
                                            <button class="time-confirm-btn" onclick="confirmTime('earlyEnd')"></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Quick Time Presets -->
                            <div style="margin-top:-8px;">
                                <div style="font-size:0.8rem; color:var(--text-sub); margin-bottom:8px; font-weight:600;">   </div>
                                <div class="time-presets">
                                    <button class="time-preset-btn" onclick="setQuickTimeEarly(0.5)">
                                        <i class="fa-solid fa-minus"></i> 30 
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTimeEarly(1.0)">
                                        <i class="fa-solid fa-minus"></i> 1 
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTimeEarly(1.5)">
                                        <i class="fa-solid fa-minus"></i> 1.5 
                                    </button>
                                    <button class="time-preset-btn" onclick="setQuickTimeEarly(2.0)">
                                        <i class="fa-solid fa-minus"></i> 2 
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Calculated Time Display -->
                            <div class="calculated-result">
                                <div class="label"> </div>
                                <div class="value">
                                    <i class="fa-solid fa-hourglass-half"></i>
                                    <span id="earlyDiff">0.0h</span>
                                </div>
                            </div>
                            
                            <!-- Reason Input -->
                            <div class="modern-input-group reason-input">
                                <label><i class="fa-solid fa-comment"></i>  </label>
                                <textarea id="earlyReason" placeholder=":     "></textarea>
                            </div>
                            
                            <!-- Submit Button -->
                            <button class="submit-btn" onclick="addRequest('early')">
                                <i class="fa-solid fa-paper-plane"></i>
                                
                            </button>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="analysis-panel" id="earlyAnalysis" style="display:none;">
                        <div style="border-bottom:1px solid var(--border); padding-bottom:10px; margin-bottom:15px;">
                            <div style="font-size:1.3rem; font-weight:800;" id="earlyAnaName">-</div><div style="font-size:0.85rem;" id="earlyAnaRole">-</div>
                        </div>
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                            <span></span>
                            <div style="display:flex; align-items:center; gap:5px;">
                                <input type="number" id="earlyBase" value="40" style="width:50px; background:transparent; border:none; border-bottom:1px solid #999; color:inherit; text-align:right;" oninput="updateAnalysis('early')">
                                <span style="color:var(--text-sub);">h</span>
                            </div>
                        </div>
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px;"><span></span><span style="font-weight:600;" id="earlyApproved">0.0 h</span></div>
                        <div style="display:flex; justify-content:space-between; margin-bottom:10px; color:var(--primary);"><span>+ </span><span style="font-weight:600;" id="earlyCurrent">0.0 h</span></div>
                        <div style="border-top:1px solid var(--border); padding-top:10px; margin-top:15px; display:flex; justify-content:space-between; align-items:center;"><span style="font-size:1.1rem; font-weight:700;">  </span><span style="font-size:1.8rem; font-weight:800; color:var(--primary);" id="earlyTotal">40.0 h</span></div>
                        <div class="progress-container"><div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:5px;"><span>Limit: 52h</span><span id="earlyAnaRemain">12h</span></div><div class="progress-track"><div class="progress-fill" id="earlyAnaFill" style="width:76%; background:var(--success)"></div></div></div>
                        <div id="earlyAlertDanger" style="margin-top:15px; padding:12px; border-radius:10px; font-size:0.95rem; font-weight:700; text-align:center; display:none; background:rgba(239,68,68,0.15); color:var(--danger); border:2px solid var(--danger); animation: alert-pulse 1.5s ease-in-out infinite;">
                            <i class="fa-solid fa-triangle-exclamation"></i> : 52 !
                        </div>
                    </div>
                    <div id="earlyPlaceholder" style="text-align:center; padding:40px; color:var(--text-sub); border:2px dashed var(--border); border-radius:16px;"> .</div>
                </div>
            </div>
            <div class="table-card" id="earlyTableArea" style="margin-top:24px;">
                <div class="table-header">
                    <div style="flex:1;">
                        <h3 style="margin:0 0 8px 0;">   </h3>
                        <div style="display:flex; gap:12px; align-items:center;">
                            <label style="font-size:0.85rem; color:var(--text-sub); font-weight:600;">
                                <i class="fa-solid fa-calendar"></i>  :
                            </label>
                            <div style="display:flex; gap:8px;">
                                <button class="filter-btn" id="earlyFilterToday" onclick="setRequestDateFilter('early', 'today')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-day"></i> 
                                </button>
                                <button class="filter-btn" onclick="setRequestDateFilter('early', 'week')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-week"></i>  
                                </button>
                                <button class="filter-btn" onclick="setRequestDateFilter('early', 'all')" style="border-radius:8px; padding:6px 12px; font-size:0.8rem;">
                                    <i class="fa-solid fa-calendar-days"></i> 
                                </button>
                            </div>
                            <div style="margin-left:8px; font-size:0.75rem; color:var(--text-sub);">
                                <span id="earlyFilterCount">0</span> 
                            </div>
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-excel" onclick="exportToExcel('early')"><i class="fa-solid fa-file-excel"></i> </button>
                        <button class="btn btn-capture" onclick="captureSection('earlyTableArea','Early_List')"><i class="fa-solid fa-camera"></i> </button>
                    </div>
                </div>
                <div style="overflow-x:auto;"><table class="weekly-table" id="earlyTable"><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th width="150"> </th><th></th><th></th></tr></thead><tbody id="earlyTbody"></tbody></table></div>
            </div>
        </div>

        <div id="tab-team" class="tab-content">
            <div class="form-container">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h3>  </h3>
                    <div class="action-buttons">
                        <button class="btn btn-excel" onclick="exportToExcel('team')"><i class="fa-solid fa-file-excel"></i>  </button>
                        <button class="btn btn-del" onclick="resetData()"><i class="fa-solid fa-rotate-right"></i> </button>
                    </div>
                </div>
                <div style="margin-top:20px; overflow-y:auto; max-height:600px;"><table class="weekly-table" id="teamTable"><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody></tbody></table></div>
            </div>
        </div>
    </main>

    <script>
        const defaultMembers = [
            {name:'',role:'Pitt (Manager)',code:'R5370913'},{name:'',role:'Van (Manager)',code:'E4992491'},
            {name:'',role:'Anton (Manager)',code:'Z7386388'},{name:'',role:'Giselle (Manager)',code:'Z5406388'},
            {name:'',role:'Justin (Manager)',code:'B3706369'},{name:'',role:'Aaron (T/C)',code:'S4461023'},
            {name:'',role:'Ralph (T/C)',code:'X4033164'},{name:'',role:'Sally (T/C)',code:'D5012685'},
            {name:'',role:'Hwan (T/C)',code:'N2086791'},{name:'',role:'Steve (T/C)',code:'W9345496'},
            {name:'',role:'Zeta (T/C)',code:'X9075186'},{name:'',role:'Bennett (T/C)',code:'H4633331'},
            {name:'',role:'Lumi (T/C)',code:'G4094768'},{name:'',role:'Eric (T/C)',code:'R9635160'},
            {name:'',role:'Bron (T/C)',code:'R2637601'},{name:'',role:'Garden (T/C)',code:'T9383022'},
            {name:'',role:'Winter (T/C)',code:'U7306474'},{name:'',role:'David (T/C)',code:'P9738071'},
            {name:'',role:'Owen (T/C)',code:'T9060243'},{name:'',role:'Liam (T/C)',code:'V6568216'},
            {name:'',role:'Damian (T/C)',code:'X7694762'},{name:'',role:'Leif (T/C)',code:'P1637348'},
            {name:'',role:'Jin (T/C)',code:'A1943868'},{name:'',role:'Jonny (T/C)',code:'V4296863'},
            {name:'',role:'Ford (T/C)',code:'G9236102'},{name:'',role:'Xenon (T/C)',code:'L5291847'},
            {name:'',role:'Colin (T/C)',code:'D9063832'},{name:'',role:'Siwoo (T/C)',code:'R8788212'},
            {name:'',role:'Sangyeong (T/C)',code:'S1827358'},{name:'',role:'Stone (T/C)',code:'M9279634'},
            {name:'',role:'Daniel (T/C)',code:'H3088014'},{name:'',role:'Leto (T/C)',code:'J7268590'},
            {name:'',role:'Wendy (T/C)',code:'G2791563'},{name:'',role:'Benny (T/C)',code:'Y5651563'},
            {name:'',role:'Freesia (T/C)',code:'N2607464'},{name:'',role:'Lily (T/C)',code:'H3614867'},
            {name:'',role:'Loosie (T/C)',code:'Q2813675'},{name:'',role:'Healer (T/C)',code:'U2554263'},
            {name:'',role:'Tani (T/C)',code:'G2345755'},{name:'',role:'Covy (T/C)',code:'A3511520'},
            {name:'',role:'Kohav (T/C)',code:'T3138750'}
        ];

        let members = JSON.parse(localStorage.getItem('gwj2_v15_members')) || defaultMembers;
        let requests = JSON.parse(localStorage.getItem('gwj2_v15_requests')) || { overtime: [], early: [] };
        
        // Filter states
        let activeFilters = { danger: false, warning: false, safe: false };
        let dashActiveFilters = { danger: false, warning: false, safe: false };
        let allWeeklyData = [];
        let allDashData = [];
        
        // Request date filters
        let requestDateFilters = {
            overtime: 'today',
            early: 'today'
        };

        window.onload = function() {
            renderDashboard(); initSelects(); renderRequestTable('overtime'); renderRequestTable('early'); renderTeamTable(); renderWeeklyTable();
            const today = new Date().toISOString().split('T')[0];
            
            // Initialize calendars
            initCalendar('ot', new Date());
            initCalendar('early', new Date());
            
            // Initialize time pickers
            initTimePicker('otStart', '18:00');
            initTimePicker('otEnd', '');
            initTimePicker('earlyStart', '08:00');
            initTimePicker('earlyEnd', '09:00');
            
            // Set today as default
            selectDate('ot', today);
            selectDate('early', today);
            
            // Set default filter buttons as active
            document.getElementById('otFilterToday').classList.add('active');
            document.getElementById('earlyFilterToday').classList.add('active');
            
            const savedTheme = localStorage.getItem('gwj2_theme') || 'dark'; document.documentElement.setAttribute('data-theme', savedTheme);
            
            // Close dropdowns on outside click
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.custom-date-picker') && !e.target.closest('.custom-time-picker')) {
                    document.querySelectorAll('.calendar-dropdown, .time-dropdown').forEach(d => d.classList.remove('show'));
                    document.querySelectorAll('.custom-date-input, .custom-time-input').forEach(i => i.classList.remove('active'));
                }
            });
        };
        
        // Calendar Functions
        let calendarStates = {
            ot: { year: new Date().getFullYear(), month: new Date().getMonth() },
            early: { year: new Date().getFullYear(), month: new Date().getMonth() }
        };
        
        function initCalendar(type, date) {
            calendarStates[type] = { year: date.getFullYear(), month: date.getMonth() };
            renderCalendar(type);
        }
        
        function toggleCalendar(type) {
            event.stopPropagation();
            const calendar = document.getElementById(`${type}Calendar`);
            const input = document.querySelector(`#${type}Calendar`).previousElementSibling.querySelector('.custom-date-input');
            
            // Close all other dropdowns
            document.querySelectorAll('.calendar-dropdown, .time-dropdown').forEach(d => {
                if (d.id !== `${type}Calendar`) d.classList.remove('show');
            });
            document.querySelectorAll('.custom-date-input, .custom-time-input').forEach(i => {
                if (i !== input) i.classList.remove('active');
            });
            
            calendar.classList.toggle('show');
            input.classList.toggle('active');
        }
        
        function renderCalendar(type) {
            const { year, month } = calendarStates[type];
            const monthYear = document.getElementById(`${type}MonthYear`);
            const daysContainer = document.getElementById(`${type}CalendarDays`);
            
            const monthNames = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
            monthYear.textContent = `${year} ${monthNames[month]}`;
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            daysContainer.innerHTML = '';
            
            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const btn = document.createElement('button');
                btn.className = 'calendar-day other-month';
                btn.textContent = daysInPrevMonth - i;
                btn.onclick = () => {
                    changeMonth(type, -1);
                    setTimeout(() => selectDate(type, `${year}-${String(month).padStart(2, '0')}-${String(daysInPrevMonth - i).padStart(2, '0')}`), 100);
                };
                daysContainer.appendChild(btn);
            }
            
            // Current month days
            const today = new Date();
            const selectedDate = document.getElementById(`${type}Date`).value;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const btn = document.createElement('button');
                btn.className = 'calendar-day';
                btn.textContent = day;
                
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                if (today.getFullYear() === year && today.getMonth() === month && today.getDate() === day) {
                    btn.classList.add('today');
                }
                
                if (selectedDate === dateStr) {
                    btn.classList.add('selected');
                }
                
                btn.onclick = () => selectDate(type, dateStr);
                daysContainer.appendChild(btn);
            }
            
            // Next month days
            const remainingDays = 42 - daysContainer.children.length;
            for (let i = 1; i <= remainingDays; i++) {
                const btn = document.createElement('button');
                btn.className = 'calendar-day other-month';
                btn.textContent = i;
                btn.onclick = () => {
                    changeMonth(type, 1);
                    setTimeout(() => selectDate(type, `${year}-${String(month + 2).padStart(2, '0')}-${String(i).padStart(2, '0')}`), 100);
                };
                daysContainer.appendChild(btn);
            }
        }
        
        function changeMonth(type, delta) {
            calendarStates[type].month += delta;
            if (calendarStates[type].month > 11) {
                calendarStates[type].month = 0;
                calendarStates[type].year++;
            } else if (calendarStates[type].month < 0) {
                calendarStates[type].month = 11;
                calendarStates[type].year--;
            }
            renderCalendar(type);
        }
        
        function selectDate(type, dateStr) {
            document.getElementById(`${type}Date`).value = dateStr;
            const display = document.getElementById(`${type}DateDisplay`);
            const date = new Date(dateStr + 'T00:00:00');
            const formatted = `${date.getFullYear()}.${String(date.getMonth() + 1).padStart(2, '0')}.${String(date.getDate()).padStart(2, '0')}`;
            display.textContent = formatted;
            display.classList.remove('placeholder');
            
            document.getElementById(`${type}Calendar`).classList.remove('show');
            document.querySelector(`#${type}Calendar`).previousElementSibling.querySelector('.custom-date-input').classList.remove('active');
            
            updateAnalysis(type === 'ot' ? 'ot' : 'early');
        }
        
        // Time Picker Functions
        let timePickerStates = {};
        
        function initTimePicker(id, defaultValue) {
            const hourScroll = document.getElementById(`${id}Hour`);
            const minuteScroll = document.getElementById(`${id}Minute`);
            
            // Populate hours (0-23)
            for (let i = 0; i <= 23; i++) {
                const option = document.createElement('div');
                option.className = 'time-option';
                option.textContent = String(i).padStart(2, '0');
                option.onclick = function() {
                    hourScroll.querySelectorAll('.time-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    timePickerStates[id] = { ...timePickerStates[id], hour: i };
                };
                hourScroll.appendChild(option);
            }
            
            // Populate minutes (0, 15, 30, 45)
            [0, 15, 30, 45].forEach(m => {
                const option = document.createElement('div');
                option.className = 'time-option';
                option.textContent = String(m).padStart(2, '0');
                option.onclick = function() {
                    minuteScroll.querySelectorAll('.time-option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                    timePickerStates[id] = { ...timePickerStates[id], minute: m };
                };
                minuteScroll.appendChild(option);
            });
            
            // Set default value
            if (defaultValue) {
                const [hour, minute] = defaultValue.split(':').map(Number);
                timePickerStates[id] = { hour, minute };
                
                setTimeout(() => {
                    const hourOption = Array.from(hourScroll.children).find(o => o.textContent === String(hour).padStart(2, '0'));
                    const minuteOption = Array.from(minuteScroll.children).find(o => o.textContent === String(minute).padStart(2, '0'));
                    if (hourOption) {
                        hourOption.classList.add('selected');
                        hourOption.scrollIntoView({ block: 'center' });
                    }
                    if (minuteOption) {
                        minuteOption.classList.add('selected');
                        minuteOption.scrollIntoView({ block: 'center' });
                    }
                }, 100);
            }
        }
        
        function toggleTimePicker(id) {
            event.stopPropagation();
            const picker = document.getElementById(`${id}Picker`);
            const input = document.querySelector(`#${id}Picker`).previousElementSibling.querySelector('.custom-time-input');
            
            // Close all other dropdowns
            document.querySelectorAll('.calendar-dropdown, .time-dropdown').forEach(d => {
                if (d.id !== `${id}Picker`) d.classList.remove('show');
            });
            document.querySelectorAll('.custom-date-input, .custom-time-input').forEach(i => {
                if (i !== input) i.classList.remove('active');
            });
            
            picker.classList.toggle('show');
            input.classList.toggle('active');
        }
        
        function confirmTime(id) {
            const state = timePickerStates[id];
            if (!state || state.hour === undefined || state.minute === undefined) {
                alert(' !');
                return;
            }
            
            const timeStr = `${String(state.hour).padStart(2, '0')}:${String(state.minute).padStart(2, '0')}`;
            document.getElementById(id).value = timeStr;
            
            const display = document.getElementById(`${id}Display`);
            display.textContent = timeStr;
            display.classList.remove('placeholder');
            
            document.getElementById(`${id}Picker`).classList.remove('show');
            document.querySelector(`#${id}Picker`).previousElementSibling.querySelector('.custom-time-input').classList.remove('active');
            
            // Trigger calculation
            if (id.includes('ot')) calcDiff('ot');
            else calcDiff('early');
        }

        function toggleTheme() { const n = document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark'; document.documentElement.setAttribute('data-theme',n); localStorage.setItem('gwj2_theme',n); }
        
        // --- Calendar View ---
        let calendarViewState = { year: new Date().getFullYear(), month: new Date().getMonth() };
        
        function renderCalendarView() {
            const { year, month } = calendarViewState;
            const monthNames = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
            
            document.getElementById('calendarMonthYear').textContent = `${year} ${monthNames[month]}`;
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            const container = document.getElementById('calendarViewDays');
            container.innerHTML = '';
            
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            
            // Previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const day = daysInPrevMonth - i;
                const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                container.appendChild(createCalendarDay(day, dateStr, true, false));
            }
            
            // Current month days
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const isToday = dateStr === todayStr;
                container.appendChild(createCalendarDay(day, dateStr, false, isToday));
            }
            
            // Next month days
            const totalCells = container.children.length;
            const remainingCells = Math.ceil(totalCells / 7) * 7 - totalCells;
            for (let day = 1; day <= remainingCells; day++) {
                const dateStr = `${year}-${String(month + 2).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                container.appendChild(createCalendarDay(day, dateStr, true, false));
            }
        }
        
        function createCalendarDay(dayNumber, dateStr, isOtherMonth, isToday) {
            const dayDiv = document.createElement('div');
            dayDiv.className = 'calendar-view-day';
            if (isOtherMonth) dayDiv.classList.add('other-month');
            if (isToday) dayDiv.classList.add('today');
            
            const dayNumDiv = document.createElement('div');
            dayNumDiv.className = 'calendar-view-day-number';
            dayNumDiv.textContent = dayNumber;
            dayDiv.appendChild(dayNumDiv);
            
            const eventsDiv = document.createElement('div');
            eventsDiv.className = 'calendar-view-events';
            
            // Get events for this date
            const events = getEventsForDate(dateStr);
            events.forEach(event => {
                const eventDiv = document.createElement('div');
                eventDiv.className = `calendar-event ${event.type}`;
                eventDiv.title = `${event.name} - ${event.start}~${event.end} (${event.time})`;
                
                eventDiv.innerHTML = `
                    <i class="fa-solid fa-${event.type === 'overtime' ? 'clock' : 'sun'}"></i>
                    <span class="calendar-event-name">${event.name}</span>
                    <span class="calendar-event-time">${event.time}</span>
                `;
                
                eventsDiv.appendChild(eventDiv);
            });
            
            dayDiv.appendChild(eventsDiv);
            return dayDiv;
        }
        
        function getEventsForDate(dateStr) {
            const events = [];
            
            // Overtime requests
            requests.overtime.forEach(r => {
                if (r.date === dateStr) {
                    events.push({
                        type: 'overtime',
                        name: r.name,
                        start: r.start,
                        end: r.end,
                        time: r.time
                    });
                }
            });
            
            // Early requests
            requests.early.forEach(r => {
                if (r.date === dateStr) {
                    events.push({
                        type: 'early',
                        name: r.name,
                        start: r.start,
                        end: r.end,
                        time: r.time
                    });
                }
            });
            
            return events;
        }
        
        function changeCalendarMonth(delta) {
            calendarViewState.month += delta;
            if (calendarViewState.month > 11) {
                calendarViewState.month = 0;
                calendarViewState.year++;
            } else if (calendarViewState.month < 0) {
                calendarViewState.month = 11;
                calendarViewState.year--;
            }
            renderCalendarView();
        }
        
        function goToToday() {
            const today = new Date();
            calendarViewState.year = today.getFullYear();
            calendarViewState.month = today.getMonth();
            renderCalendarView();
        }
        function switchTab(t) { 
            document.querySelectorAll('.nav-item,.tab-content').forEach(e=>e.classList.remove('active')); 
            event.currentTarget.classList.add('active'); 
            document.getElementById(`tab-${t}`).classList.add('active'); 
            const titles = {dashboard:'', calendar:' ', weekly:'  ()', overtime:' ', early:' ', team:' '};
            document.getElementById('pageTitle').innerText = titles[t];
            if(t==='dashboard')renderDashboard(); 
            if(t==='calendar')renderCalendarView();
            if(t==='weekly')renderWeeklyTable(); 
        }

        // --- Weekly Table with Filters ---
        function renderWeeklyTable() {
            const tbody = document.getElementById('weeklyTbody');
            const widgets = document.getElementById('weeklyWidgets');
            
            let data = members.map(m => { 
                const base=40; 
                const approved=calcTotalApprovedTime(m.name); 
                return { name:m.name, role:m.role, total:base+approved }; 
            });
            data.sort((a,b)=>b.total-a.total);
            
            allWeeklyData = data; // Store for filtering
            applyFilters(); // Apply current filters
        }
        
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const tbody = document.getElementById('weeklyTbody');
            const widgets = document.getElementById('weeklyWidgets');
            
            let filteredData = allWeeklyData.filter(d => {
                // Search filter
                const matchesSearch = d.name.toLowerCase().includes(searchTerm) || 
                                     d.role.toLowerCase().includes(searchTerm);
                
                // Status filter
                let status = 'safe';
                if(d.total >= 52) status = 'danger';
                else if(d.total >= 45) status = 'warning';
                
                const hasActiveFilter = activeFilters.danger || activeFilters.warning || activeFilters.safe;
                const matchesStatus = !hasActiveFilter || activeFilters[status];
                
                return matchesSearch && matchesStatus;
            });
            
            tbody.innerHTML = '';
            let cntDanger=0, cntWarning=0, cntSafe=0;

            filteredData.forEach((d, idx) => {
                const remain = 52 - d.total;
                const percent = Math.min((d.total/52)*100, 100);
                let rowClass='', status='', barColor='var(--success)';
                
                if(d.total >= 52) { status=''; rowClass='row-danger'; barColor='var(--danger)'; cntDanger++; }
                else if(d.total >= 45) { status=''; rowClass='row-warning'; barColor='var(--warning)'; cntWarning++; }
                else { cntSafe++; }

                tbody.innerHTML += `
                    <tr class="${rowClass}">
                        <td style="text-align:center; font-weight:bold; color:var(--text-sub)">${idx+1}</td>
                        <td><div style="font-weight:700">${d.name}</div><div style="font-size:0.75rem; color:var(--text-sub)">${d.role}</div></td>
                        <td><div style="display:flex; justify-content:space-between; font-size:0.75rem;"><span>${Math.round(percent)}%</span></div><div class="tbl-gauge"><div class="tbl-fill" style="width:${percent}%; background:${barColor}"></div></div></td>
                        <td style="text-align:right; font-weight:800; color:${barColor}; font-size:1.1rem;">${d.total.toFixed(1)} h</td>
                        <td style="text-align:center"><span class="status-badge" style="border:1px solid ${barColor}; color:${barColor}">${status}</span></td>
                        <td style="text-align:right; color:var(--text-sub)">${remain.toFixed(1)} h</td>
                    </tr>`;
            });

            widgets.innerHTML = `
                <div class="widget-card"><div class="widget-icon" style="background:var(--primary)"><i class="fa-solid fa-users"></i></div><div class="widget-text"><div> </div><div>${filteredData.length}</div></div></div>
                <div class="widget-card" style="border-color:var(--danger)"><div class="widget-icon" style="background:var(--danger)"><i class="fa-solid fa-ban"></i></div><div class="widget-text"><div> (52h+)</div><div>${cntDanger}</div></div></div>
                <div class="widget-card" style="border-color:var(--warning)"><div class="widget-icon" style="background:var(--warning)"><i class="fa-solid fa-triangle-exclamation"></i></div><div class="widget-text"><div> (45h+)</div><div>${cntWarning}</div></div></div>
                <div class="widget-card"><div class="widget-icon" style="background:var(--success)"><i class="fa-solid fa-check"></i></div><div class="widget-text"><div></div><div>${cntSafe}</div></div></div>
            `;
        }
        
        function toggleFilter(type) {
            activeFilters[type] = !activeFilters[type];
            const btn = document.querySelector(`.filter-${type}`);
            btn.classList.toggle('active');
            applyFilters();
        }
        
        function clearFilters() {
            activeFilters = { danger: false, warning: false, safe: false };
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('searchInput').value = '';
            applyFilters();
        }

        // --- Dashboard with Filters ---
        function renderDashboard() {
            allDashData = members.map(m => {
                const isMgr = m.role.includes('Manager');
                const total = 40 + calcTotalApprovedTime(m.name);
                const remain = 52 - total;
                const percent = Math.min((total/52)*100, 100);
                let statusClass='safe'; 
                if(total>=52) statusClass='danger'; 
                else if(total>=45) statusClass='warning';
                
                return { ...m, isMgr, total, remain, percent, statusClass };
            });
            
            applyDashFilters();
        }
        
        function applyDashFilters() {
            const searchTerm = document.getElementById('dashSearchInput').value.toLowerCase();
            const mgr = document.getElementById('managerGrid');
            const tc = document.getElementById('tcGrid');
            mgr.innerHTML = '';
            tc.innerHTML = '';
            
            let filteredData = allDashData.filter(d => {
                // Search filter
                const matchesSearch = d.name.toLowerCase().includes(searchTerm) || 
                                     d.role.toLowerCase().includes(searchTerm);
                
                // Status filter
                const hasActiveFilter = dashActiveFilters.danger || dashActiveFilters.warning || dashActiveFilters.safe;
                const matchesStatus = !hasActiveFilter || dashActiveFilters[d.statusClass];
                
                return matchesSearch && matchesStatus;
            });
            
            filteredData.forEach(d => {
                const card = document.createElement('div'); 
                card.className = `member-card ${d.statusClass} ${d.isMgr ? 'manager-card' : 'captain-card'}`;
                card.innerHTML = `
                    <div class="card-top"><div class="card-info"><div>${d.name}</div><div>${d.role}</div></div><div class="card-badge">${d.total.toFixed(1)}h</div></div>
                    <div class="progress-container"><div class="progress-labels"><span>Limit: 52h</span><span class="progress-val">: ${d.remain.toFixed(1)}h</span></div><div class="progress-track"><div class="progress-fill" style="width:${d.percent}%"></div></div></div>`;
                if(d.isMgr) mgr.appendChild(card); 
                else tc.appendChild(card);
            });
        }
        
        function toggleDashFilter(type) {
            dashActiveFilters[type] = !dashActiveFilters[type];
            const btn = document.querySelectorAll('#tab-dashboard .filter-btn')[type === 'danger' ? 0 : type === 'warning' ? 1 : 2];
            btn.classList.toggle('active');
            applyDashFilters();
        }
        
        function clearDashFilters() {
            dashActiveFilters = { danger: false, warning: false, safe: false };
            document.querySelectorAll('#tab-dashboard .filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('dashSearchInput').value = '';
            applyDashFilters();
        }

        function calcTotalApprovedTime(name) {
            const d=new Date(), day=d.getDay(), diff=d.getDate()-day; 
            const sun=new Date(d.setDate(diff)); sun.setHours(0,0,0,0);
            const sat=new Date(sun); sat.setDate(sun.getDate()+6); sat.setHours(23,59,59,999);
            let t=0;
            [...requests.overtime, ...requests.early].forEach(r => { if(r.name===name) { const rd=new Date(r.date); if(rd>=sun && rd<=sat) t+=parseFloat(r.time.replace('h',''))||0; } });
            return t;
        }

        function updateAnalysis(type) {
            const idx = document.getElementById(`${type}Select`).value;
            const panel = document.getElementById(`${type}Analysis`), ph = document.getElementById(`${type}Placeholder`);
            if(idx==="") { panel.style.display='none'; ph.style.display='block'; return; }
            panel.style.display='block'; ph.style.display='none';

            const m = members[idx];
            document.getElementById(`${type}AnaName`).innerText = m.name; document.getElementById(`${type}AnaRole`).innerText = m.role;
            const base = parseFloat(document.getElementById(`${type}Base`).value)||0;
            const currText = document.getElementById(`${type}Diff`).innerText || '0.0h';
            const curr = parseFloat(currText.replace('h',''))||0;
            
            let approved = 0;
            const inputDate = document.getElementById(`${type}Date`).value;
            if(inputDate) {
                const target = new Date(inputDate), day=target.getDay(), diff=target.getDate()-day;
                const sun=new Date(target.setDate(diff)); sun.setHours(0,0,0,0);
                const sat=new Date(sun); sat.setDate(sun.getDate()+6); sat.setHours(23,59,59,999);
                [...requests.overtime, ...requests.early].forEach(r => { if(r.name===m.name) { const rd=new Date(r.date); if(rd>=sun && rd<=sat) approved+=parseFloat(r.time.replace('h',''))||0; } });
            }

            const total = base + approved + curr;
            const remain = 52 - total;
            const percent = Math.min((total/52)*100, 100);

            document.getElementById(`${type}Approved`).innerText = approved.toFixed(1)+' h';
            document.getElementById(`${type}Current`).innerText = curr.toFixed(1)+' h';
            document.getElementById(`${type}Total`).innerText = total.toFixed(1)+' h';
            
            document.getElementById(`${type}AnaRemain`).innerText = remain.toFixed(1)+'h';
            const fill = document.getElementById(`${type}AnaFill`);
            fill.style.width = percent + '%';

            const dang=document.getElementById(`${type}AlertDanger`);
            dang.style.display='none'; fill.style.background='var(--success)';
            if(total>=52) { dang.style.display='block'; fill.style.background='var(--danger)'; }
            else if(total>=45) { fill.style.background='var(--warning)'; }
        }

        // --- Excel Export with PROPER Styling ---
        function exportToExcel(type) {
            let wb = XLSX.utils.book_new();
            let ws_data = [];
            
            if(type === 'weekly') {
                ws_data.push(['GWJ2 OB    ']);
                ws_data.push([': ' + new Date().toLocaleString('ko-KR')]);
                ws_data.push([]);
                ws_data.push(['', '', '', '  ', '', ' ']);
                
                let data = members.map(m => { 
                    const base=40; 
                    const approved=calcTotalApprovedTime(m.name); 
                    return { name:m.name, role:m.role, total:base+approved }; 
                });
                data.sort((a,b)=>b.total-a.total);
                
                data.forEach((d, idx) => {
                    const remain = 52 - d.total;
                    let status = '';
                    if(d.total >= 52) status = '';
                    else if(d.total >= 45) status = '';
                    
                    ws_data.push([
                        idx + 1,
                        d.name,
                        d.role,
                        d.total.toFixed(1) + 'h',
                        status,
                        remain.toFixed(1) + 'h'
                    ]);
                });
                
            } else if(type === 'overtime' || type === 'early') {
                ws_data.push([type === 'overtime' ? '   ' : '   ']);
                ws_data.push([': ' + new Date().toLocaleString('ko-KR')]);
                ws_data.push([]);
                ws_data.push(['', '', '', '', '', '', '', '', '', '', '']);
                
                requests[type].forEach(r => {
                    const total = 40 + calcTotalApprovedTime(r.name);
                    let status = '';
                    if(total >= 52) status = '';
                    else if(total >= 45) status = '';
                    ws_data.push([r.name, r.nick, r.rank, r.code, r.date, r.start, r.end, r.time, total.toFixed(1) + 'h', status, r.reason]);
                });
                
            } else if(type === 'team') {
                ws_data.push(['  ']);
                ws_data.push([': ' + new Date().toLocaleString('ko-KR')]);
                ws_data.push([]);
                ws_data.push(['', '', '', '']);
                
                members.forEach(m => {
                    const rank = m.role.includes('Manager') ? 'Manager' : 'T/C';
                    const nick = m.role.split(' ')[0];
                    ws_data.push([m.name, nick, rank, m.code]);
                });
            }
            
            let ws = XLSX.utils.aoa_to_sheet(ws_data);
            
            // Column widths
            if(type === 'weekly') {
                ws['!cols'] = [{wch: 8}, {wch: 15}, {wch: 25}, {wch: 15}, {wch: 12}, {wch: 15}];
            } else if(type === 'team') {
                ws['!cols'] = [{wch: 12}, {wch: 20}, {wch: 12}, {wch: 15}];
            } else {
                ws['!cols'] = [{wch: 12}, {wch: 15}, {wch: 12}, {wch: 15}, {wch: 12}, {wch: 10}, {wch: 10}, {wch: 12}, {wch: 12}, {wch: 10}, {wch: 35}];
            }
            
            XLSX.utils.book_append_sheet(wb, ws, type === 'weekly' ? '' : type === 'overtime' ? '' : type === 'early' ? '' : '');
            
            const filename = `GWJ2_${type}_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, filename);
        }

        // --- Utils ---
        function initSelects() { 
            const o='<option value=""></option>'+members.map((m,i)=>`<option value="${i}">${m.name} (${m.role})</option>`).join(''); 
            document.getElementById('otSelect').innerHTML=o; 
            document.getElementById('earlySelect').innerHTML=o; 
        }
        
        function setShiftTime(type) {
            const shift = document.getElementById(`${type}Shift`).value;
            if (!shift) return;
            
            if (type === 'ot') {
                //  :     
                if (shift === 'day') {
                    // DAY: 18:00    18:00  
                    setTimeValue('otStart', '18:00');
                    setTimeValue('otEnd', ''); //   
                } else if (shift === 'swing') {
                    // SWING: 04:00    04:00  
                    setTimeValue('otStart', '04:00');
                    setTimeValue('otEnd', ''); //   
                }
            } else {
                //  :     
                if (shift === 'day') {
                    // DAY: 09:00    09:00  
                    setTimeValue('earlyEnd', '09:00');
                    setTimeValue('earlyStart', ''); //   
                } else if (shift === 'swing') {
                    // SWING: 19:00    19:00  
                    setTimeValue('earlyEnd', '19:00');
                    setTimeValue('earlyStart', ''); //   
                }
            }
            
            calcDiff(type === 'ot' ? 'ot' : 'early');
        }
        
        function setTimeValue(id, timeStr) {
            const display = document.getElementById(`${id}Display`);
            
            if (!timeStr) {
                // 
                document.getElementById(id).value = '';
                display.textContent = ' ';
                display.classList.add('placeholder');
                return;
            }
            
            const [hour, minute] = timeStr.split(':').map(Number);
            
            // Update hidden input
            document.getElementById(id).value = timeStr;
            
            // Update display
            display.textContent = timeStr;
            display.classList.remove('placeholder');
            
            // Update time picker state
            timePickerStates[id] = { hour, minute };
            
            // Update selected options in scroll
            const hourScroll = document.getElementById(`${id}Hour`);
            const minuteScroll = document.getElementById(`${id}Minute`);
            
            if (hourScroll) {
                hourScroll.querySelectorAll('.time-option').forEach(o => o.classList.remove('selected'));
                const hourOption = Array.from(hourScroll.children).find(o => o.textContent === String(hour).padStart(2, '0'));
                if (hourOption) {
                    hourOption.classList.add('selected');
                    hourOption.scrollIntoView({ block: 'center', behavior: 'smooth' });
                }
            }
            
            if (minuteScroll) {
                minuteScroll.querySelectorAll('.time-option').forEach(o => o.classList.remove('selected'));
                const minuteOption = Array.from(minuteScroll.children).find(o => o.textContent === String(minute).padStart(2, '0'));
                if (minuteOption) {
                    minuteOption.classList.add('selected');
                    minuteOption.scrollIntoView({ block: 'center', behavior: 'smooth' });
                }
            }
        }
        
        function setQuickTime(t, h) {
            //  :      
            const startId = `${t}Start`;
            const endId = `${t}End`;
            
            const startValue = document.getElementById(startId).value;
            if (!startValue) {
                alert('      !');
                return;
            }
            
            const [startHour, startMinute] = startValue.split(':').map(Number);
            
            // Calculate end time (add h hours)
            const totalMinutes = (startHour * 60 + startMinute) + (h * 60);
            let endHour = Math.floor(totalMinutes / 60) % 24;
            let endMinute = totalMinutes % 60;
            
            // Round to nearest 15 minutes
            endMinute = Math.round(endMinute / 15) * 15;
            if (endMinute === 60) {
                endMinute = 0;
                endHour = (endHour + 1) % 24;
            }
            
            const endTime = `${String(endHour).padStart(2, '0')}:${String(endMinute).padStart(2, '0')}`;
            setTimeValue(endId, endTime);
            
            calcDiff(t);
        }
        
        function setQuickTimeEarly(h) {
            const startId = 'earlyStart';
            const endId = 'earlyEnd';
            
            const endValue = document.getElementById(endId).value;
            if (!endValue) {
                setTimeValue(endId, '09:00');
            }
            
            const currentEnd = document.getElementById(endId).value;
            const [endHour, endMinute] = currentEnd.split(':').map(Number);
            
            // Calculate start time (go back h hours)
            const totalMinutes = (endHour * 60 + endMinute) - (h * 60);
            let startHour = Math.floor(totalMinutes / 60);
            let startMinute = totalMinutes % 60;
            
            if (startHour < 0) startHour += 24;
            if (startMinute < 0) {
                startMinute += 60;
                startHour -= 1;
                if (startHour < 0) startHour += 24;
            }
            
            // Round to nearest 15 minutes
            startMinute = Math.round(startMinute / 15) * 15;
            if (startMinute === 60) {
                startMinute = 0;
                startHour = (startHour + 1) % 24;
            }
            
            const startTime = `${String(startHour).padStart(2, '0')}:${String(startMinute).padStart(2, '0')}`;
            setTimeValue(startId, startTime);
            
            calcDiff('early');
        }
        
        function calcDiff(t) { 
            const s=document.getElementById(`${t}Start`).value, e=document.getElementById(`${t}End`).value; 
            if(s&&e){ 
                const S=new Date(`2000-01-01 ${s}`), E=new Date(`2000-01-01 ${e}`); 
                if(E<S) E.setDate(E.getDate()+1); 
                const hours = ((E-S)/36e5).toFixed(1);
                document.getElementById(`${t}Diff`).innerText = hours + 'h'; 
            } else {
                document.getElementById(`${t}Diff`).innerText = '0.0h'; 
            }
            updateAnalysis(t); 
        }
        
        function addRequest(t) { 
            const idx=document.getElementById(`${t==='overtime'?'ot':'early'}Select`).value; 
            if(idx==="")return alert(" !"); 
            const m=members[idx], p=t==='overtime'?'ot':'early', date=document.getElementById(`${p}Date`).value;
            const timeText = document.getElementById(`${p}Diff`).innerText || '0.0h';
            const reason = document.getElementById(`${p}Reason`).value;
            
            if(!date) return alert(" !");
            if(parseFloat(timeText.replace('h','')) <= 0) return alert(" !");
            if(!reason.trim()) return alert(" !");
            
            const nick = m.role.split(' ')[0];
            const rank = m.role.includes('Manager') ? 'Manager' : 'T/C';
            
            requests[t].push({
                id:Date.now(), 
                name:m.name, 
                nick:nick, 
                rank:rank, 
                code:m.code, 
                date:date, 
                start:document.getElementById(`${p}Start`).value, 
                end:document.getElementById(`${p}End`).value, 
                time:timeText, 
                reason:reason
            });
            
            localStorage.setItem('gwj2_v15_requests', JSON.stringify(requests)); 
            renderRequestTable(t); 
            updateAnalysis(p); 
            renderWeeklyTable(); 
            
            // Reset form
            document.getElementById(`${p}Reason`).value = '';
            
            alert("  !");
        }
        
        function renderRequestTable(type) {
            // Map short names to full names
            const tbodyId = type === 'overtime' ? 'ot' : 'early';
            const requestKey = type; // 'overtime' or 'early'
            
            const b = document.getElementById(`${tbodyId}Tbody`); 
            b.innerHTML='';
            
            // Ensure requests array exists
            if (!requests[requestKey]) {
                requests[requestKey] = [];
            }
            
            const filter = requestDateFilters[requestKey] || 'today';
            const today = new Date().toISOString().split('T')[0];
            
            let filteredRequests = requests[requestKey];
            
            if (filter === 'today') {
                filteredRequests = requests[requestKey].filter(r => r.date === today);
            } else if (filter === 'week') {
                const d = new Date();
                const day = d.getDay();
                const diff = d.getDate() - day;
                const sun = new Date(d.setDate(diff));
                sun.setHours(0, 0, 0, 0);
                const sat = new Date(sun);
                sat.setDate(sun.getDate() + 6);
                sat.setHours(23, 59, 59, 999);
                
                filteredRequests = requests[requestKey].filter(r => {
                    const rd = new Date(r.date + 'T00:00:00');
                    return rd >= sun && rd <= sat;
                });
            }
            
            // Update count
            const countEl = document.getElementById(`${tbodyId}FilterCount`);
            if (countEl) countEl.textContent = filteredRequests.length;
            
            filteredRequests.forEach((r,i)=>{ 
                const total = 40 + calcTotalApprovedTime(r.name);
                const remain = 52 - total;
                const percent = Math.min((total/52)*100, 100);
                let statusColor = 'var(--success)';
                if(total >= 52) statusColor = 'var(--danger)';
                else if(total >= 45) statusColor = 'var(--warning)';
                
                // Find original index for deletion
                const originalIndex = requests[requestKey].findIndex(req => req.id === r.id);
                
                b.innerHTML+=`<tr>
                    <td>${r.name}</td>
                    <td>${r.nick}</td>
                    <td>${r.rank}</td>
                    <td>${r.code}</td>
                    <td>${r.date.substring(5)}</td>
                    <td style="font-size:0.85rem;color:var(--text-sub)">${r.start}~${r.end}</td>
                    <td style="font-weight:bold;color:var(--primary)">${r.time}</td>
                    <td>
                        <div style="font-size:0.75rem;color:var(--text-sub);margin-bottom:4px;">${total.toFixed(1)}h / 52h</div>
                        <div style="width:100%;height:6px;background:var(--border);border-radius:4px;overflow:hidden;">
                            <div style="width:${percent}%;height:100%;background:${statusColor};border-radius:4px;"></div>
                        </div>
                    </td>
                    <td>${r.reason}</td>
                    <td><button class="btn btn-del" onclick="deleteRequest('${requestKey}',${originalIndex})"><i class="fa-solid fa-trash"></i></button></td>
                </tr>`; 
            }); 
        }
        
        function setRequestDateFilter(type, filter) {
            requestDateFilters[type] = filter;
            
            // Update button states
            const tbodyId = type === 'overtime' ? 'ot' : 'early';
            
            // Remove active from all filter buttons for this type
            const buttonContainer = document.getElementById(`${tbodyId}FilterToday`).parentElement;
            buttonContainer.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active to clicked button
            if (filter === 'today') {
                document.getElementById(`${tbodyId}FilterToday`).classList.add('active');
            } else if (filter === 'week') {
                buttonContainer.querySelectorAll('.filter-btn')[1].classList.add('active');
            } else if (filter === 'all') {
                buttonContainer.querySelectorAll('.filter-btn')[2].classList.add('active');
            }
            
            renderRequestTable(type);
        }
        
        function deleteRequest(t,i) { 
            if(confirm('?')){ 
                requests[t].splice(i,1); 
                localStorage.setItem('gwj2_v15_requests', JSON.stringify(requests)); 
                renderRequestTable(t); 
                renderDashboard(); 
                renderWeeklyTable(); 
                const p=t==='overtime'?'ot':'early'; 
                if(document.getElementById(`${p}Analysis`).style.display!=='none') updateAnalysis(p); 
            } 
        }
        
        function renderTeamTable() { 
            const b=document.getElementById('teamTable').querySelector('tbody'); 
            b.innerHTML=''; 
            members.forEach(m=>{
                const nick = m.role.split(' ')[0];
                const rank = m.role.includes('Manager') ? 'Manager' : 'T/C';
                b.innerHTML+=`<tr><td>${m.name}</td><td>${nick}</td><td>${rank}</td><td>${m.code}</td></tr>`;
            });
        }
        
        function resetData() { 
            if(confirm('  ?')){ 
                localStorage.removeItem('gwj2_v15_requests'); 
                location.reload(); 
            } 
        }
        
        function captureSection(id, name) { 
            const el=document.getElementById(id), btns=el.querySelectorAll('button'); 
            btns.forEach(b=>b.style.opacity=0);
            const isDark = document.documentElement.getAttribute('data-theme')==='dark';
            html2canvas(el, {backgroundColor:isDark?'#1e293b':'#ffffff', scale:1.5}).then(c=>{ 
                const l=document.createElement('a'); 
                l.download=`${name}.png`; 
                l.href=c.toDataURL(); 
                l.click(); 
                btns.forEach(b=>b.style.opacity=1); 
            });
        }
    </script>
</body>
</html>